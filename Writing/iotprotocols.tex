\section{A Typical IoT Protocol Stack\label{sec: IotProtocols}} 
%A typical sensor network is built as described in \ref{Protocols}.
%IoT Protocols
Many protocols are proposed for different IoT applications adapting to various requirements. For example, some smart houses simply use WiFi for connectivity and VANETs\footnote{Vehicular ad hoc networks} may adopt DSRC\cite{DSRC}. 

%WSN Protocols
In this paper we focused on 6LoWPAN\cite{rfc4944} which is based on 802.15.4\cite{802154}. These standards are designated for constrained environments such as Wireless Sensor Networks,  but other competing standards exist at different layers. Bluetooth Low Energy(BLE)\cite{BLE} is a strong competitor to 802.15.4 as well as the LiFi\cite{LiFi} technology. Zigbee\cite{Zigbee} is originally intended as a collective protocol over 802.15.4 but it has been recently adapted to IP-based network in ZigbeeIP\cite{ZigbeeIp} so to compete with 6LoWPAN. The RIME stack\cite{RIME} proposed a set of non-layered primitives over 802.15.4 but it is likely to be phased-out probably due to the reluctance of interoperability with the TCP/IP protocol stack of Internet. 

%6LoWPAN OS
6LoWPAN is supported by several competing IoT Operating Systems, including Contiki OS\cite{Contiki}, OpenWSN\cite{OpenWSN}, FreeRTOS\cite{FreeRTOS} and the recent RIOT\cite{RIOT}. Contiki OS is chosen for our experiments for its customisability.

\subsection{Our experimental network}
%Say something about devices, and choice of OS, etc.
%Hardware
Our experiment networks are constructed using devices constituted of TelosB\cite{TelosB} and CC2538\cite{CC2538}. TelosB is a low cost sensor powered by MSP430 with AES co-processor representing the low-end devices. CC2538 is the high end device powered by ARM Cortex-M3 with multiple cryptographic processors including AES, RSA, SHA-2 and ECC, suggesting it for security usage.
%Should I cite our previous paper...?

%Software
On the software side, we by principle adopted the default settings of Contiki OS, except enabling 802.15.4 Security\cite{802154} upon its study. Note that Contiki MAC\cite{ContikiMAC} is chosen by default over TSCH\cite{TSCH}, albeit we would argue the channel information of TSCH could be an additional leakage source. For Layer 4\cite{OSI} and above protocols, we considered the widely accepted combination of CoAP\cite{rfc7252} over DTLS\cite{rfc6347}(optional) over UDP\cite{rfc768}\footnote{CoAPs is equivalent to CoAP over DTLS.}. \Cref{Protocols} summarises our choice of protocol stack.

\begin{table}[!h]
	\centering
	\input{tbl/protocols.tex}
	\caption{Protocol stack for our experiments(* is optinal)\label{Protocols}}
\end{table}

%\begin{itemize}
%	\item Security options in 6LoWPAN: 802.15.4 Security and DTLS.
%	\item Eavesdropping is easier for 6LoWPAN.
%\end{itemize}

%Avaible security options.
For our settings, there are two schemes available for packet encryption, namely 802.15.4 Security\cite{802154} and DTLS\cite{rfc6347}. 802.15.4 Security is provided by noncoresec\cite{noncoresec} which implements 802.15.4 authenticated encryption with AES-128 CCM*\cite{CCM} using a hard-coded key shared by the whole 6LoWPAN network. tinyDTLS\cite{tinydtls} provides a minimum DTLS implementation that supports only two ciphersuites which are TLS\_PSK\_WITH\_AES\_128\_CCM\_8\cite{rfc6655} and TLS\_ECDHE\_ECDSA\_WITH\_AES\_128\_CCM\_8\cite{rfc6655} respectively. We do not concern the case where both 802.15.4 Security and DTLS are enabled simultaneously, as the de facto encryption schemes are both AES-128 CCM*. Overlapping them does not enhance the security but only increases the overhead.